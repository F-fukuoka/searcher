<!DOCTYPE html>
<html lang="ja">
<head>
    <link href='main.css' rel="stylesheet" type="text/css">
    
    <meta charset="UTF-8">
    <title>口癖searcher</title>
</head>
<body>

    <h1>口癖Searcher</h1>
    <h3>~使い方~<br>
      ①STARTを押す<br>
      ②STOPを押す<br>
      ③検出したい口癖を入力<br>
      ④Searchを押す<br>
      ⑤SAVEを押して保存<br>
      ※マイクを近づけて話してください<br>
      ※沈黙だと自動停止するので、もう一度STARTを押す
    </h3>


    <div class="bt"><span>
        <input type="button" class="b1" id="btn" value="START" onclick="func(this)">
        <input type="button" class="b2" id="btn2" value="SAVE" onclick="window.open('https://docs.google.com/document/u/0/')">
             </span>
    </div>
    <div class="kensaku"><br>
        <input type="text" name="id" class="textb1" placeholder="口癖①">
        <input type="text" name="id" class="textb2" placeholder="口癖②"><br>
        <input type="text" name="id" class="textb3" placeholder="口癖③">
        <input type="text" name="id" class="textb4" placeholder="口癖④"><br>
        <input type="text" name="id" class="textb5" placeholder="口癖⑤">
        <input type="text" name="id" class="textb6" placeholder="口癖⑥"><br>
        <input type="text" name="id" class="textb7" placeholder="口癖⑦">
        <input type="text" name="id" class="textb8" placeholder="口癖⑧"><br>
    
        <input type="checkbox" id="ku1"class="k1" value="1">
        <label for="ku1">えー　</label>
         <input type="checkbox" id="ku2"class="k2" value="2">
        <label for="ku2">なるほど　</label>
        <input type="checkbox" id="ku3"class="k3" value="3">
        <label for="ku3">そうですね　</label><br>
        <input type="checkbox" id="ku4"class="k4" value="4">
        <label for="ku4">ていうか　</label>
        <input type="checkbox" id="ku5"class="k5" value="5">
        <label for="ku5">あの　</label>
        <input type="checkbox" id="ku6"class="k6" value="6">
        <label for="ku6">それは　</label><br>
        <input type="checkbox" id="ku7"class="k7" value="7">
        <label for="ku7">えっと　</label>
        <input type="checkbox" id="ku8"class="k8" value="8">
     </div><br>

       <div class="btn">
        <input type="button" class="b3" value="Search">
    </div>
      <br>
       <div id="result"
        style="padding: 10px; margin-bottom: 10px;
        border: 5px double #333333; border-radius: 10px;" class="text">口癖が〇回検出されました！</div>
        <div id="result-div"
        style="padding: 10px; margin-bottom: 10px;
        border: 5px double #333333; border-radius: 10px;" class="text2"></div>
    <!--文字化したものを表示-->
    <!--html終了 画面レイアウト-->

<script>
    const btn = document.querySelector('#btn');
    const btn2 = document.querySelector('#btn2');
    const resultDiv = document.querySelector('#result-div');
    

    
    SpeechRecognition = webkitSpeechRecognition || SpeechRecognition;
    let recognition = new SpeechRecognition();
  
    recognition.lang = 'ja-JP';
    recognition.interimResults = true;//音声認識しっぱなしにする(ただし、沈黙が続くと終了)
    recognition.continuous = true;
  
    let finalTranscript = ''; // 確定した(黒の)認識結果
  
    recognition.onresult = (event) => {
      let interimTranscript = ''; // 暫定(灰色)の認識結果
      for (let i = event.resultIndex; i < event.results.length; i++) {
        let transcript = event.results[i][0].transcript;
        if (event.results[i].isFinal) {
          finalTranscript += transcript;
        } else {
          interimTranscript = transcript;
        }
      }
      resultDiv.innerHTML = finalTranscript + '<i style="color:#ddd;">' + interimTranscript + '</i>';
    }


  function func(Button){
if( Button.value == "START" ){
  recognition.start();
  Button.value = "STOP";
  return;
  }
if( Button.value == "STOP" ){
  recognition.stop();
  Button.value = "START";
  return;
  }
}
  
 
    function ng_word_check($text2 , $ng_word_array){
/*********************
*	$textにチェック対象のテキスト、$ng_word_arrayにはNGワードの配列が入ります。
*	$text中にNGワードが存在しなければ、0を返します。
*********************/
	str_replace($ng_word_array, $ng_word_array , $text2, $count);
	return $count ;
}

$ng_word_array=array('えー　','あの　','そうですね　','ていうか　','えっと　','なるほど　','それは　');
if( ng_word_check($text2 , $ng_word_array) == 0 ){
	//echo "NGワードは含まれていませんでした";
}

  </script>
  </body>
  </html>
  